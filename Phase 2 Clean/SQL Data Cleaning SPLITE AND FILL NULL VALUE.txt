STAGE1: SPLIT TABLE FOR READY TO BE FILLED 

--1 (null start_station_id): 236 cases
CREATE TABLE sharing_bike_dataset_1 AS
SELECT *
FROM sharing_bike_dataset
WHERE
(start_station_id IS NULL AND start_station_name IS NOT NULL) AND (end_station_id IS NOT NULL AND end_station_name IS NOT NULL)


--2 (null start_station_name): 1
CREATE TABLE sharing_bike_dataset_2 AS
SELECT *
FROM sharing_bike_dataset
WHERE
(start_station_id IS NOT NULL AND start_station_name IS NULL) AND (end_station_id IS NOT NULL AND end_station_name IS NOT NULL)


--3 (null end_station_id): 117
CREATE TABLE sharing_bike_dataset_3 AS
SELECT *
FROM sharing_bike_dataset
WHERE 
(start_station_id IS NOT NULL AND start_station_name IS NOT NULL) AND (end_station_id IS NULL AND end_station_name IS NOT NULL)


--4 (null start_station_id and null end_station_id) : 23
CREATE TABLE sharing_bike_dataset_4 AS
SELECT *
FROM sharing_bike_dataset
WHERE 
(start_station_id IS NULL AND start_station_name IS NOT NULL) AND (end_station_id IS NULL AND end_station_name IS NOT NULL)


CREATE TABLE sharing_bike_dataset_full AS 
SELECT *
FROM sharing_bike_dataset
WHERE 
(start_station_id IS not NULL AND start_station_name IS NOT NULL) AND (end_station_id IS not NULL AND end_station_name IS NOT NULL)


CREATE TABLE sharing_bike_dataset_start_station_ref AS 
SELECT 
	DISTINCT start_station_id, 
	start_station_name
FROM sharing_bike_dataset_full


CREATE TABLE sharing_bike_dataset_end_station_ref AS 
SELECT 
	DISTINCT end_station_id, 
	end_station_name
FROM sharing_bike_dataset_full


-----------------------------------------------------------

STAGE2: FILL NULL VALUE 

-- 1
UPDATE sharing_bike_dataset_1 as t1
	SET start_station_id = (SELECT start_station_id from sharing_bike_dataset_start_station_ref as r WHERE t1.start_station_name = r.start_station_name)
WHERE start_station_id IS NULL;


-- 2
UPDATE sharing_bike_dataset_2 as t1
	SET start_station_name = (SELECT start_station_name from sharing_bike_dataset_start_station_ref as r WHERE t1.start_station_id = r.start_station_id)
WHERE start_station_name IS NULL;


-- 3
UPDATE sharing_bike_dataset_3 as t1
	SET end_station_id = (SELECT end_station_id from sharing_bike_dataset_end_station_ref as r WHERE t1.end_station_name = r.end_station_name)
WHERE end_station_id IS NULL;


-- 4
update sharing_bike_dataset_4 as t1
SET start_station_id = (SELECT start_station_id FROM sharing_bike_dataset_start_station_ref as r WHERE r.start_station_name = t1.start_station_name)
WHERE start_station_id is NULL;

update sharing_bike_dataset_4 as t1
SET end_station_id = (SELECT start_station_id FROM sharing_bike_dataset_end_station_ref as r WHERE r.end_station_name = t1.end_station_name)
WHERE end_station_id is NULL;